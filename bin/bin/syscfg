#!/usr/bin/env bash

SESSION="syscfg"
DIR="$HOME/.dotfiles"

# If session exists, attach directly to dotfiles window
if tmux has-session -t "$SESSION" 2>/dev/null; then
  tmux attach -t "$SESSION:dotfiles"
  exit 0
fi

# Create session (detached)
tmux new-session -d -s "$SESSION" -n dotfiles -c "$DIR"

# Start Neovim
tmux send-keys -t "$SESSION:dotfiles" "nvim" C-m

# Create shell window (detached, never focused)
tmux new-window -d -t "$SESSION" -n shell -c "$DIR"

# Give Neovim time
sleep 0.4

# Trigger <leader>e (Space + e)
tmux send-keys -t "$SESSION:dotfiles" " e"

# ðŸš¨ ATTACH DIRECTLY TO DOTFILES WINDOW
tmux attach -t "$SESSION:dotfiles"
